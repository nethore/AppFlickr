$(document).ready(function(){function e(e){e=e.reverse();var i=e[e.length-1];t(s,i),$(".selecteur li a[name="+i+"]").parent().addClass("active")}function i(e){e=e.reverse(),$("ul#nav-mobile li").remove(),$("ul#mobile-demo li").remove(),$("div.chip-holder div.chip").remove(),$("ul#mobile-demo p").remove();for(var i="",a="",t="",s=0;s<e.length;s++)i+='<li><a href="#" name="'+e[s]+'">'+e[s]+"</a></li>",console.log(i),a+='<li><a href="#" name="'+e[s]+'">'+e[s]+"</a></li>",t+='<div class="chip" name="'+e[s]+'">'+e[s]+'<i class="close-chip material-icons">close</i></div>';$("div.chip-holder").prepend(t),$("ul#nav-mobile").prepend(i),$("ul#mobile-demo").prepend(a),$("ul#mobile-demo").prepend("<p>Veuillez sélectionner un tag à afficher :</p>")}function a(e){var i="";$.each(e.items,function(e,a){return e!=n&&(i+='<div class="grid-item"><div class="card light-blue darken-3">',i+='<div class="card-image waves-effect waves-block waves-light"><img class="activator" src="'+a.media.m+'"></div>',i+='<div class="card-reveal"><span class="card-title grey-text text-darken-4">Tags<i class="material-icons right">close</i></span><p class="tags"><span>'+a.tags+'</span></p><p><a class="waves-effect waves-light btn" href="'+a.link+'" target="_blank">Ouvrir  sur Flickr</a></p></div>',void(i+="</div></div>"))}),$(".loader-div").show(),$(".grid").html(i).masonry("remove",$(".grid").find("grid-item")).masonry("destroy").css("visibility","hidden").imagesLoaded(function(){$(".grid").masonry({itemSelector:".grid-item",gutter:20,fitWidth:!0,columnWidth:300}).css("visibility","visible")}).done(function(){$(".loader-div").hide()})}function t(e,i){$.ajax({url:e,dataType:"jsonp",data:{tags:i,format:"json"},success:function(e){a(e)}})}$(".affiche-sidebar").sideNav(),$(".button-collapse").sideNav({edge:"right"});var s="http://api.flickr.com/services/feeds/photos_public.gne?jsoncallback=?",n=20,r=[];sessionStorage.tags?(r=JSON.parse(sessionStorage.tags),console.log("SS",r)):(r=["bateau","avion","train","velo","voiture"],console.log("SS Vide"));var o=/[^\, ]+/gi;i(r),e(r),$("input#range-image").change(function(){n=$("input#range-image").val(),$("span.img-counter").text(n),t(s,currentTag)}),$("button#add-tag").click(function(){var a=$(this).parents("form").find("input#tags").val().toLowerCase();if(""!==a){var t=a.match(o);r=r.concat(t),sessionStorage.setItem("tags",JSON.stringify(r)),i(r),e(r),Materialize.toast("Tag(s) ajouté(s)",2e3),$(this).parents("form").find("input#tags").val("")}}),$("input#tags").bind("keypress",function(a){if(13==a.keyCode){var t=$(this).val().toLowerCase();if(""!==t){var s=t.match(o);r=r.concat(s),sessionStorage.setItem("tags",JSON.stringify(r)),i(r),e(r),Materialize.toast("Tag(s) ajouté(s)",2e3),$(this).val("")}}}),$("div.chip-holder").on("click","i.close-chip",function(){var a=$(this).parent().attr("name"),t=r.indexOf(a);t>-1&&r.splice(t,1),sessionStorage.setItem("tags",JSON.stringify(r)),i(r),e(r)}),$(".selecteur").on("click","a",function(){$(this).parents(".selecteur").find("li").removeClass("active"),$(this).parent().addClass("active"),$(this).sideNav("hide")}),$(".selecteur").on("click","a",function(){currentTag=$(this).attr("name"),t(s,currentTag)}),$(".loader-div").hide().ajaxStart(function(){$(this).show()}).ajaxStop(function(){$(this).hide()})});